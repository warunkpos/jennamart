<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@ionic/core/css/ionic.bundle.css" />
    <style>
        .example-content {
            padding: 14px;
            height: 85vh;
            overflow-x: scroll;
        }

        .custom-card {
            margin: 8px;
        }

        .relative{
            position: relative;
        }
        .ion-btn-card{
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
    </style>
</head>

<body>
    <ion-tabs>
        <ion-tab tab="master">
            <ion-nav id="master-nav"></ion-nav>
            <div id="master-page">
                <ion-header>
                    <ion-toolbar>
                        <ion-title>Warunk</ion-title>
                    </ion-toolbar>
                </ion-header>
                <div class="example-content">
                    <h4>Submit Product</h4>
                    <br>
                    <form id="formSubmit">
                        <ion-input id="pluname" label="PLU Name" type="text" label-placement="floating" fill="outline"
                            placeholder="Enter PLU Name" required></ion-input>
                        <br>
                        <ion-input id="price" label="Price" type="number" label-placement="floating" fill="outline"
                            placeholder="Enter Price" required></ion-input>
                        <br>
                        <!-- <ion-input id="image" label="Image" type="file"></ion-input> -->
                        <ion-button id="submit" expand="block" class="ion-padding-vertical">Submit</ion-button>
                    </form>
                    <ion-toast id="errorSubmit" color="danger"></ion-toast>
                </div>
            </div>
        </ion-tab>
        <ion-tab tab="product">
            <ion-nav id="product-nav"></ion-nav>
            <div id="product-page">
                <ion-header>
                    <ion-toolbar>
                        <ion-title>Warunk</ion-title>
                    </ion-toolbar>
                </ion-header>
                <div class="example-content">
                    <ion-searchbar debounce="1000"></ion-searchbar>
                    <ion-grid class="ion-no-padding relative">
                        <ion-row id="listProducts"> </ion-row>
                    </ion-grid>
                </div>
            </div>
        </ion-tab>

        <ion-tab-bar slot="bottom">
            <ion-tab-button tab="master">
                <ion-icon name="cube-outline"></ion-icon>
                Master
            </ion-tab-button>
            <ion-tab-button tab="product">
                <ion-icon name="stats-chart-outline"></ion-icon>
                Product
            </ion-tab-button>
        </ion-tab-bar>
    </ion-tabs>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.esm.js"></script>
    <script nomodule src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/ionicons/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://cdn.jsdelivr.net/npm/ionicons/dist/ionicons/ionicons.js"></script>
    <script>
        function setCookie(cname, cvalue) {
            const d = new Date();
            d.setTime(d.getTime() + (10 * 24 * 60 * 60 * 1000));
            let expires = "expires=" + d.toUTCString();
            document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
        }

        const form = document.getElementById('formSubmit');
        const pluname = document.getElementById('pluname');
        const price = document.getElementById('price');
        const submitBtn = document.getElementById('submit');

        submitBtn.addEventListener('click', (e) => {

            e.preventDefault();
            document.cookie = "username=Max Brown";
            localStorage.setItem("lastname", "Smith");
            var toast = document.getElementById("errorSubmit");
            if (pluname.value === "") {
                toast.isOpen = true;
                toast.message = "Plu Number is Required"
            } else if (price.value === "") {
                toast.isOpen = true;
                toast.message = "Price is Required"

            } else {
                const formData = {
                    username: pluname.value,
                    password: price.value,
                };
                // Form submission logic goes here
                console.log(formData);
                document.cookie = "products" + "=" + formData;
                // setCookie("products", formData)
            }
            setTimeout(() => {
                toast.isOpen = false;
            }, 2000);
        });


        ///list products------------------
        const products = [{
            "id": 1,
            "pluname": "Masako",
            "price": 4500
        }, {
            "id": 2,
            "pluname": "Royko",
            "price": 4500
        }, {
            "id": 3,
            "pluname": "Sabun Lervia",
            "price": 3000
        }, {
            "id": 4,
            "pluname": "Sabun GIV",
            "price": 2500
        }, {
            "id": 5,
            "pluname": "Sabun Harmony",
            "price": 1500
        }]

        function appendListProducts(data) {
            for (var i = 0; i <= data.length; i++) {
                var dataHtml = `
                <ion-col class="ion-no-padding"  size-sm="6">
                    <ion-card class="custom-card">
                        <img alt="Silhouette of mountains"
                            src="https://ionicframework.com/docs/img/demos/card-media.png" />
                        <ion-card-header>
                            <ion-card-title>`+data[i].pluname+`</ion-card-title>
                            <ion-card-subtitle>`+data[i].price+`</ion-card-subtitle>
                        </ion-card-header> 
                        <ion-button class="ion-btn-card">Add</ion-button>
                    </ion-card>
                </ion-col> `;
                $('#listProducts').append(dataHtml)
            }
        }
        appendListProducts(products);

        const searchbar = document.querySelector('ion-searchbar');
        const items = Array.from(document.getElementById('listProducts').children);
        searchbar.addEventListener('ionInput', handleInput);
        function handleInput(event) {
            const query = event.target.value.toLowerCase();
            requestAnimationFrame(() => {
                items.forEach(item => {
                    const shouldShow = item.textContent.toLowerCase().indexOf(query) > -1;
                    item.style.display = shouldShow ? 'block' : 'none';
                });
            });
        }

    </script>
</body>

</html>